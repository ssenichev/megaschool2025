# AI Talent Hub | МегаШкола 2025

## Результат
Данное решение заняло 1-е место по количеству правильных ответов среди более 200 решений от других участников. На общем лидерборде, после оценки решения судьями, решение заняло 3-е место.

## Решение
В виду временных ограничений на выполнение задания и отсутствия личных ресурсов
на сервинг моделей, самым доступным решением являлось использование API-моделей.

Итоговый пайплайн выглядит данным образом:  
1. Поиск данных через `DuckDuckGo API`; Топ-5 запросов по региону Россия
2. Параллельно идет запрос с модель от Perplexity - `llama-3.1-sonar-large-128k-online`. Это сделано по 2-м причинам: (1) у этой модели также
есть доступ в интернет и она способна на поиск, помимо своих данных из претрейна и (2) из-за ограничения DuckDuckGO API на запросы (которое нигде не указано и абстрактно), иногда нужны доп. знания для основной модели.
3. Итоговый запрос идет в `gpt-4o-mini` в формате: вопрос юзера, ответ и размышления Perplexity модели + запросы из поисковика.

В виду описанных раннее ограничений, не удалось провести достаточно количество экспериментов
для выведения лучшего пайплайна.


## Проверка по API
Если сервис всё еще будет поднят на момент вашего чтения, то endpoint доступен с помощью
```bash
curl --location --request POST 'https://itmo-agent-a1b39bda5a86.herokuapp.com/api/request' \
--header 'Content-Type: application/json' \
--data-raw '{
  "query": "В каком городе находится главный кампус Университета ИТМО?\n1. Москва\n2. Санкт-Петербург\n3. Екатеринбург\n4. Нижний Новгород",
  "id": 1
}'
```

## Сборка Docker образа
Для запуска выполните команду:
```
docker-compose up -d
```
Она соберёт Docker-образ, а затем запустит контейнер.  
После успешного запуска контейнера приложение будет доступно на http://localhost:8000.

## Проверка работы
Отправьте POST-запрос на эндпоинт /api/request. Например, используйте curl:

```bash
curl --location --request POST 'http://localhost:8000/api/request' \
--header 'Content-Type: application/json' \
--data-raw '{
  "query": "В каком городе находится главный кампус Университета ИТМО?\n1. Москва\n2. Санкт-Петербург\n3. Екатеринбург\n4. Нижний Новгород",
  "id": 1
}'
```
В ответ вы получите JSON вида:

```json
{
  "id": 1,
  "answer": 1,
  "reasoning": "Из информации на сайте",
  "sources": [
    "https://itmo.ru/ru/",
    "https://abit.itmo.ru/"
  ]
}
```

## Кастомизация
Чтобы изменить логику ответа, отредактируйте функцию handle_request в main.py.
Если нужно использовать дополнительные библиотеки, добавьте их в requirements.txt и пересоберите образ.
